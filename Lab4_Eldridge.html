<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lab 4 - Eldridge</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Lab4_Eldridge_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lab4_Eldridge_files/libs/quarto-html/quarto.js"></script>
<script src="Lab4_Eldridge_files/libs/quarto-html/popper.min.js"></script>
<script src="Lab4_Eldridge_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lab4_Eldridge_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lab4_Eldridge_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lab4_Eldridge_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lab4_Eldridge_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lab4_Eldridge_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lab4_Eldridge_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 4 - Eldridge</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="cell-1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1 - Starbucks</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://worldpopulationreview.com/state-rankings/starbucks-stores-by-state'</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> requests.get(url)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>response.raise_for_status()</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>soup <span class="op">=</span> BeautifulSoup(response.content, <span class="st">'html.parser'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> soup.find(<span class="st">'table'</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>header_row <span class="op">=</span> table.find(<span class="st">'tr'</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> [th.text.strip() <span class="cf">for</span> th <span class="kw">in</span> header_row.find_all(<span class="st">'th'</span>)] <span class="co">#Chat GPT - Extract only the first &lt;tr&gt; with &lt;th&gt; tags to get the correct headers</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>headers[<span class="dv">0</span>] <span class="op">=</span> <span class="st">'State'</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Headers:"</span>, headers)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Headers:"</span>, <span class="bu">len</span>(headers))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> table.find_all(<span class="st">'tr'</span>)[<span class="dv">1</span>:]:</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    state_name <span class="op">=</span> row.find(<span class="st">'th'</span>).text.strip()</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> [col.text.strip() <span class="cf">for</span> col <span class="kw">in</span> row.find_all(<span class="st">'td'</span>)]</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    cols.insert(<span class="dv">0</span>, state_name)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(cols) <span class="op">&lt;</span> <span class="bu">len</span>(headers):</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        cols.extend([np.nan] <span class="op">*</span> (<span class="bu">len</span>(headers) <span class="op">-</span> <span class="bu">len</span>(cols)))  </span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">len</span>(cols) <span class="op">&gt;</span> <span class="bu">len</span>(headers):</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        cols <span class="op">=</span> cols[:<span class="bu">len</span>(headers)]  <span class="co">#GPT - Truncate extra columns</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    data.append(cols)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>df_starbucks <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>headers)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_starbucks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Headers: ['State', 'Starbucks Stores 2023', 'Starbucks Stores 2021', 'Starbucks Stores 2024']
Number of Headers: 4
                   State Starbucks Stores 2023 Starbucks Stores 2021  \
0             California                 3,080                 2,959   
1                  Texas                 1,346                 1,215   
2                Florida                   844                   786   
3             Washington                   741                   739   
4               New York                   692                   643   
5               Illinois                   677                   621   
6                Arizona                   548                   535   
7               Colorado                   495                   497   
8                   Ohio                   491                   446   
9               Virginia                   489                   456   
10                Oregon                   359                   345   
11          Pennsylvania                   357                   406   
12        North Carolina                   338                   422   
13               Georgia                   326                   379   
14              Michigan                   283                   310   
15         Massachusetts                   273                   279   
16            New Jersey                   261                   293   
17              Maryland                   257                   274   
18                Nevada                   253                   269   
19               Indiana                   221                   265   
20              Missouri                   188                   208   
21             Minnesota                   184                   212   
22             Tennessee                   180                   237   
23              Kentucky                   166                   131   
24             Wisconsin                   145                   176   
25        South Carolina                   131                   207   
26           Connecticut                   123                   125   
27                  Utah                   101                   126   
28                Hawaii                    99                   105   
29                Kansas                    94                   120   
30  District of Columbia                    91                         
31                  Iowa                    89                   142   
32               Alabama                    85                    99   
33             Louisiana                    84                    10   
34              Oklahoma                    79                    94   
35            New Mexico                    76                    92   
36                 Idaho                    67                    78   
37              Nebraska                    58                    87   
38              Arkansas                    55                    66   
39                Alaska                    49                    49   
40           Mississippi                    32                    36   
41               Montana                    32                    45   
42                 Maine                    30                    31   
43         New Hampshire                    29                    35   
44          Rhode Island                    27                    26   
45              Delaware                    25                    39   
46          South Dakota                    25                    52   
47         West Virginia                    25                    64   
48               Wyoming                    23                    26   
49          North Dakota                    13                    20   
50               Vermont                     8                    35   

   Starbucks Stores 2024  
0                  3,117  
1                  1,409  
2                    892  
3                    736  
4                    715  
5                    685  
6                    579  
7                    506  
8                    499  
9                    510  
10                        
11                        
12                        
13                        
14                        
15                        
16                        
17                        
18                        
19                        
20                        
21                        
22                        
23                        
24                        
25                        
26                        
27                        
28                        
29                        
30                        
31                        
32                        
33                        
34                        
35                        
36                        
37                        
38                        
39                        
40                        
41                        
42                        
43                        
44                        
45                        
46                        
47                        
48                        
49                        
50                        </code></pre>
</div>
</div>
<div id="cell-2" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1 - Dunkin</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>url_dunkin <span class="op">=</span> <span class="st">'https://worldpopulationreview.com/state-rankings/dunkin-donuts-by-state'</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>response_dunkin <span class="op">=</span> requests.get(url_dunkin)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>response_dunkin.raise_for_status()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>soup_dunkin <span class="op">=</span> BeautifulSoup(response_dunkin.content, <span class="st">'html.parser'</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>table_dunkin <span class="op">=</span> soup_dunkin.find(<span class="st">'table'</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>header_row_dunkin <span class="op">=</span> table_dunkin.find(<span class="st">'tr'</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>headers_dunkin <span class="op">=</span> [th.text.strip() <span class="cf">for</span> th <span class="kw">in</span> header_row_dunkin.find_all(<span class="st">'th'</span>)]</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>headers_dunkin[<span class="dv">0</span>] <span class="op">=</span> <span class="st">'State'</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Headers:"</span>, headers_dunkin)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of Headers:"</span>, <span class="bu">len</span>(headers_dunkin))</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> []</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> table_dunkin.find_all(<span class="st">'tr'</span>)[<span class="dv">1</span>:]:</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    state_name <span class="op">=</span> row.find(<span class="st">'th'</span>).text.strip()</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> [col.text.strip() <span class="cf">for</span> col <span class="kw">in</span> row.find_all(<span class="st">'td'</span>)]</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    cols.insert(<span class="dv">0</span>, state_name)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(cols) <span class="op">&lt;</span> <span class="bu">len</span>(headers_dunkin):</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>        cols.extend([np.nan] <span class="op">*</span> (<span class="bu">len</span>(headers_dunkin) <span class="op">-</span> <span class="bu">len</span>(cols)))  </span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">len</span>(cols) <span class="op">&gt;</span> <span class="bu">len</span>(headers_dunkin):</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        cols <span class="op">=</span> cols[:<span class="bu">len</span>(headers_dunkin)]  <span class="co">#ChatGPT - Truncate if extra columns exist</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    data.append(cols)</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>df_dunkin <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>headers_dunkin)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_dunkin)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Headers: ['State', 'Dunkin Locations 2024', 'Dunkin Locations 2023']
Number of Headers: 3
                   State Dunkin Locations 2024 Dunkin Locations 2023
0               New York                 1,431                 1,414
1          Massachusetts                 1,042                 1,068
2                Florida                   909                   883
3             New Jersey                   872                   866
4               Illinois                   711                   692
5           Pennsylvania                   650                   629
6            Connecticut                   476                   480
7               Maryland                   311                   303
8                Georgia                   287                   265
9                   Ohio                   261                   245
10              Virginia                   244                   230
11                 Texas                   226                   196
12        North Carolina                   224                   206
13         New Hampshire                   216                   218
14                 Maine                   164                   159
15          Rhode Island                   159                   160
16            California                   143                   134
17             Tennessee                   137                   123
18               Indiana                   117                   104
19        South Carolina                   116                   103
20              Michigan                   112                   105
21               Arizona                   110                   102
22             Wisconsin                   100                    83
23               Alabama                    69                    59
24              Delaware                    67                    66
25              Missouri                    54                    50
26              Kentucky                    50                    41
27               Vermont                    50                    49
28              Colorado                    48                    43
29                Nevada                    42                    38
30             Minnesota                    38                    34
31                  Iowa                    36                    34
32         West Virginia                    31                    27
33                Kansas                    26                    28
34              Nebraska                    24                    23
35              Oklahoma                    23                    18
36  District of Columbia                    19                      
37            New Mexico                    19                    19
38             Louisiana                    15                    16
39              Arkansas                    14                     9
40           Mississippi                    14                    12
41                Hawaii                     6                     6
42                  Utah                     2                     1
43               Wyoming                     1                     1
44                Alaska                     0                     0
45                 Idaho                     0                     0
46               Montana                     0                     0
47          North Dakota                     0                     0
48                Oregon                     0                     0
49          South Dakota                     0                     0
50            Washington                     0                    19</code></pre>
</div>
</div>
<div id="cell-3" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#2 - Tidy the data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df_starbucks_tidy <span class="op">=</span> pd.melt(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    df_starbucks,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    id_vars<span class="op">=</span>[<span class="st">'State'</span>],  </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    var_name<span class="op">=</span><span class="st">'Year'</span>,    </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">'Starbucks Stores'</span>  </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>df_starbucks_tidy[<span class="st">'Year'</span>] <span class="op">=</span> df_starbucks_tidy[<span class="st">'Year'</span>].<span class="bu">str</span>.extract(<span class="st">'(\d</span><span class="sc">{4}</span><span class="st">)'</span>) <span class="co">#Chat GPT - Extract the year from the column names</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_starbucks_tidy.head())</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>df_dunkin_tidy <span class="op">=</span> pd.melt(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    df_dunkin,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    id_vars<span class="op">=</span>[<span class="st">'State'</span>], </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    var_name<span class="op">=</span><span class="st">'Year'</span>,   </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    value_name<span class="op">=</span><span class="st">'Dunkin Stores'</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>df_dunkin_tidy[<span class="st">'Year'</span>] <span class="op">=</span> df_dunkin_tidy[<span class="st">'Year'</span>].<span class="bu">str</span>.extract(<span class="st">'(\d</span><span class="sc">{4}</span><span class="st">)'</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_dunkin_tidy)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        State  Year Starbucks Stores
0  California  2023            3,080
1       Texas  2023            1,346
2     Florida  2023              844
3  Washington  2023              741
4    New York  2023              692
             State  Year Dunkin Stores
0         New York  2024         1,431
1    Massachusetts  2024         1,042
2          Florida  2024           909
3       New Jersey  2024           872
4         Illinois  2024           711
..             ...   ...           ...
97         Montana  2023             0
98    North Dakota  2023             0
99          Oregon  2023             0
100   South Dakota  2023             0
101     Washington  2023            19

[102 rows x 3 columns]</code></pre>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge the Data</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df_combined <span class="op">=</span> pd.merge(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    df_starbucks_tidy, df_dunkin_tidy,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    on<span class="op">=</span>[<span class="st">'State'</span>, <span class="st">'Year'</span>],</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    how<span class="op">=</span><span class="st">'outer'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_combined.head())</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>df_combined.fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     State  Year Starbucks Stores Dunkin Stores
0  Alabama  2021               99           NaN
1  Alabama  2023               85            59
2  Alabama  2024                             69
3   Alaska  2021               49           NaN
4   Alaska  2023               49             0
         State  Year Starbucks Stores Dunkin Stores
0      Alabama  2021               99             0
1      Alabama  2023               85            59
2      Alabama  2024                             69
3       Alaska  2021               49             0
4       Alaska  2023               49             0
..         ...   ...              ...           ...
148  Wisconsin  2023              145            83
149  Wisconsin  2024                            100
150    Wyoming  2021               26             0
151    Wyoming  2023               23             1
152    Wyoming  2024                              1

[153 rows x 4 columns]</code></pre>
</div>
</div>
<div id="cell-5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df_combined.to_csv(<span class="st">'tidy_store_data.csv'</span>, index<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#4 - Wikipedia</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>url_population <span class="op">=</span> <span class="st">'https://simple.wikipedia.org/wiki/List_of_U.S._states_by_population'</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>response_population <span class="op">=</span> requests.get(url_population)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>response_population.raise_for_status()</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>soup_population <span class="op">=</span> BeautifulSoup(response_population.content, <span class="st">'html.parser'</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>table_population <span class="op">=</span> soup_population.find(<span class="st">'table'</span>, {<span class="st">'class'</span>: <span class="st">'wikitable sortable'</span>})</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>data_population <span class="op">=</span> []</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> table_population.find_all(<span class="st">'tr'</span>)[<span class="dv">1</span>:]:  </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    cols <span class="op">=</span> [col.text.strip() <span class="cf">for</span> col <span class="kw">in</span> row.find_all([<span class="st">'th'</span>, <span class="st">'td'</span>])]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> cols[<span class="dv">2</span>] <span class="kw">in</span> [<span class="st">"District of Columbia"</span>, <span class="st">"Puerto Rico"</span>] <span class="kw">or</span> <span class="bu">len</span>(data_population) <span class="op">&gt;=</span> <span class="dv">50</span>:</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span>  </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>    state_name <span class="op">=</span> cols[<span class="dv">2</span>] </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    population_2020 <span class="op">=</span> cols[<span class="dv">3</span>].replace(<span class="st">','</span>, <span class="st">''</span>)  </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    data_population.append([state_name, <span class="bu">int</span>(population_2020)])</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>df_population <span class="op">=</span> pd.DataFrame(data_population, columns<span class="op">=</span>[<span class="st">'State'</span>, <span class="st">'Population_2020'</span>])</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_population)  </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             State  Population_2020
0       California         39538223
1            Texas         30145505
2          Florida         21538187
3         New York         20201249
4     Pennsylvania         13002700
5         Illinois         12812508
6             Ohio         11799448
7          Georgia         10711908
8   North Carolina         10439388
9         Michigan         10077331
10      New Jersey          9288994
11        Virginia          8631393
12      Washington          7705281
13         Arizona          7151502
14   Massachusetts          7029917
15       Tennessee          6910840
16         Indiana          6785528
17        Maryland          6177224
18        Missouri          6154913
19       Wisconsin          5893718
20        Colorado          5773714
21       Minnesota          5706494
22  South Carolina          5118425
23         Alabama          5024279
24       Louisiana          4657757
25        Kentucky          4505836
26          Oregon          4237256
27        Oklahoma          3959353
28     Connecticut          3605944
29            Utah          3271616
30            Iowa          3190369
31          Nevada          3104614
32        Arkansas          3011524
33     Mississippi          2961279
34          Kansas          2937880
35      New Mexico          2117522
36        Nebraska          1961504
37           Idaho          1839106
38   West Virginia          1793716
39          Hawaii          1455271
40   New Hampshire          1377529
41           Maine          1362359
42    Rhode Island          1097379
43         Montana          1084225
44        Delaware           989948
45    South Dakota           886667
46    North Dakota           779094
47          Alaska           733391
48         Vermont           643077
49         Wyoming           576851</code></pre>
</div>
</div>
<div id="cell-7" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df_combined[<span class="st">'State'</span>] <span class="op">=</span> df_combined[<span class="st">'State'</span>].<span class="bu">str</span>.strip()  <span class="co"># Ensure matching state names</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df_merged <span class="op">=</span> pd.merge(df_combined, df_population, on<span class="op">=</span><span class="st">'State'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         State  Year Starbucks Stores Dunkin Stores  Population_2020
0      Alabama  2021               99             0          5024279
1      Alabama  2023               85            59          5024279
2      Alabama  2024                             69          5024279
3       Alaska  2021               49             0           733391
4       Alaska  2023               49             0           733391
..         ...   ...              ...           ...              ...
145  Wisconsin  2023              145            83          5893718
146  Wisconsin  2024                            100          5893718
147    Wyoming  2021               26             0           576851
148    Wyoming  2023               23             1           576851
149    Wyoming  2024                              1           576851

[150 rows x 5 columns]</code></pre>
</div>
</div>
<div id="cell-8" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#5 - Financial Metric</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'Company'</span> <span class="kw">in</span> df_merged.columns:</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    df_merged <span class="op">=</span> df_merged.drop(columns<span class="op">=</span>[<span class="st">'Company'</span>])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>stock_data <span class="op">=</span> {</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Year'</span>: [<span class="dv">2021</span>, <span class="dv">2023</span>, <span class="dv">2024</span>], </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Starbucks_Stock'</span>: [<span class="dv">105</span>, <span class="dv">107</span>, <span class="dv">92</span>], </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Dunkin_Stock'</span>: [<span class="dv">77</span>, <span class="dv">82</span>, <span class="dv">79</span>]  </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>df_stocks <span class="op">=</span> pd.DataFrame(stock_data)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>df_merged[<span class="st">'Year'</span>] <span class="op">=</span> df_merged[<span class="st">'Year'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>df_stocks[<span class="st">'Year'</span>] <span class="op">=</span> df_stocks[<span class="st">'Year'</span>].astype(<span class="bu">int</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>df_final <span class="op">=</span> pd.merge(df_merged, df_stocks, on<span class="op">=</span><span class="st">'Year'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         State  Year Starbucks Stores Dunkin Stores  Population_2020  \
0      Alabama  2021               99             0          5024279   
1      Alabama  2023               85            59          5024279   
2      Alabama  2024                             69          5024279   
3       Alaska  2021               49             0           733391   
4       Alaska  2023               49             0           733391   
..         ...   ...              ...           ...              ...   
145  Wisconsin  2023              145            83          5893718   
146  Wisconsin  2024                            100          5893718   
147    Wyoming  2021               26             0           576851   
148    Wyoming  2023               23             1           576851   
149    Wyoming  2024                              1           576851   

     Starbucks_Stock  Dunkin_Stock  
0                105            77  
1                107            82  
2                 92            79  
3                105            77  
4                107            82  
..               ...           ...  
145              107            82  
146               92            79  
147              105            77  
148              107            82  
149               92            79  

[150 rows x 7 columns]</code></pre>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#6 - Regions</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>region_mapping <span class="op">=</span> {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Northeast'</span>: [</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Connecticut'</span>, <span class="st">'Maine'</span>, <span class="st">'Massachusetts'</span>, <span class="st">'New Hampshire'</span>, <span class="st">'Rhode Island'</span>, <span class="st">'Vermont'</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'New Jersey'</span>, <span class="st">'New York'</span>, <span class="st">'Pennsylvania'</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Midwest'</span>: [</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Illinois'</span>, <span class="st">'Indiana'</span>, <span class="st">'Michigan'</span>, <span class="st">'Ohio'</span>, <span class="st">'Wisconsin'</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Iowa'</span>, <span class="st">'Kansas'</span>, <span class="st">'Minnesota'</span>, <span class="st">'Missouri'</span>, <span class="st">'Nebraska'</span>, <span class="st">'North Dakota'</span>, <span class="st">'South Dakota'</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'South'</span>: [</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Delaware'</span>, <span class="st">'Florida'</span>, <span class="st">'Georgia'</span>, <span class="st">'Maryland'</span>, <span class="st">'North Carolina'</span>, <span class="st">'South Carolina'</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Virginia'</span>, <span class="st">'West Virginia'</span>, <span class="st">'Alabama'</span>, <span class="st">'Kentucky'</span>, <span class="st">'Mississippi'</span>, <span class="st">'Tennessee'</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Arkansas'</span>, <span class="st">'Louisiana'</span>, <span class="st">'Oklahoma'</span>, <span class="st">'Texas'</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'West'</span>: [</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Arizona'</span>, <span class="st">'Colorado'</span>, <span class="st">'Idaho'</span>, <span class="st">'Montana'</span>, <span class="st">'Nevada'</span>, <span class="st">'New Mexico'</span>, <span class="st">'Utah'</span>, <span class="st">'Wyoming'</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Alaska'</span>, <span class="st">'California'</span>, <span class="st">'Hawaii'</span>, <span class="st">'Oregon'</span>, <span class="st">'Washington'</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_region(state):</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> region, states <span class="kw">in</span> region_mapping.items():</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> state <span class="kw">in</span> states:</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> region</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">'Unknown'</span>  </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>df_final[<span class="st">'Region'</span>] <span class="op">=</span> df_final[<span class="st">'State'</span>].<span class="bu">apply</span>(get_region)</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         State  Year Starbucks Stores Dunkin Stores  Population_2020  \
0      Alabama  2021               99             0          5024279   
1      Alabama  2023               85            59          5024279   
2      Alabama  2024                             69          5024279   
3       Alaska  2021               49             0           733391   
4       Alaska  2023               49             0           733391   
..         ...   ...              ...           ...              ...   
145  Wisconsin  2023              145            83          5893718   
146  Wisconsin  2024                            100          5893718   
147    Wyoming  2021               26             0           576851   
148    Wyoming  2023               23             1           576851   
149    Wyoming  2024                              1           576851   

     Starbucks_Stock  Dunkin_Stock   Region  
0                105            77    South  
1                107            82    South  
2                 92            79    South  
3                105            77     West  
4                107            82     West  
..               ...           ...      ...  
145              107            82  Midwest  
146               92            79  Midwest  
147              105            77     West  
148              107            82     West  
149               92            79     West  

[150 rows x 8 columns]</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#7 - Graph (bar chart)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, geom_bar, labs, theme_bw</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>df_final[[<span class="st">'Starbucks Stores'</span>, <span class="st">'Dunkin Stores'</span>]] <span class="op">=</span> (</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    df_final[[<span class="st">'Starbucks Stores'</span>, <span class="st">'Dunkin Stores'</span>]]</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    .replace(<span class="st">''</span>, <span class="st">'0'</span>)  </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    .fillna(<span class="dv">0</span>)  </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">str</span>)  </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.<span class="bu">str</span>.replace(<span class="st">','</span>, <span class="st">''</span>, regex<span class="op">=</span><span class="va">True</span>))  </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    .astype(<span class="bu">int</span>)  </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>region_data <span class="op">=</span> df_final.groupby(<span class="st">'Region'</span>)[[<span class="st">'Starbucks Stores'</span>, <span class="st">'Dunkin Stores'</span>]].<span class="bu">sum</span>().reset_index()</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>region_data_melted <span class="op">=</span> region_data.melt(</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    id_vars<span class="op">=</span><span class="st">'Region'</span>, var_name<span class="op">=</span><span class="st">'Chain'</span>, value_name<span class="op">=</span><span class="st">'Stores'</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>plot <span class="op">=</span> (</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    ggplot(region_data_melted, aes(x<span class="op">=</span><span class="st">'Region'</span>, y<span class="op">=</span><span class="st">'Stores'</span>, fill<span class="op">=</span><span class="st">'Chain'</span>)) <span class="op">+</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    geom_bar(stat<span class="op">=</span><span class="st">'identity'</span>, position<span class="op">=</span><span class="st">'dodge'</span>) <span class="op">+</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    labs(title<span class="op">=</span><span class="st">'Store Counts by Region and Chain'</span>, x<span class="op">=</span><span class="st">'Region'</span>, y<span class="op">=</span><span class="st">'Number of Stores'</span>) <span class="op">+</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    theme_bw()</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/jb/g1z659_j7g7g3c677k1x2bsc0000gn/T/ipykernel_42033/1599131610.py:31: FutureWarning: Using print(plot) to draw and show the plot figure is deprecated and will be removed in a future version. Use plot.show().</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4_Eldridge_files/figure-html/cell-11-output-2.png" width="230" height="172" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#7 - Graph (Scatter Plot)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotnine <span class="im">import</span> ggplot, aes, geom_point, geom_smooth, labs, theme_bw</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>df_final[<span class="st">'Total Stores'</span>] <span class="op">=</span> (</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    df_final[[<span class="st">'Starbucks Stores'</span>, <span class="st">'Dunkin Stores'</span>]].fillna(<span class="dv">0</span>).astype(<span class="bu">int</span>).<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>region_population <span class="op">=</span> df_final.groupby(<span class="st">'Region'</span>).agg({</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Population_2020'</span>: <span class="st">'sum'</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Total Stores'</span>: <span class="st">'sum'</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>}).reset_index()</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>plot <span class="op">=</span> (</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>    ggplot(region_population, aes(x<span class="op">=</span><span class="st">'Population_2020'</span>, y<span class="op">=</span><span class="st">'Total Stores'</span>, color<span class="op">=</span><span class="st">'Region'</span>)) <span class="op">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    geom_point(size<span class="op">=</span><span class="dv">4</span>) <span class="op">+</span> </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    geom_smooth(method<span class="op">=</span><span class="st">'lm'</span>, se<span class="op">=</span><span class="va">False</span>, linetype<span class="op">=</span><span class="st">'dashed'</span>, color<span class="op">=</span><span class="st">'black'</span>) <span class="op">+</span>  <span class="co">#ChatGPT - Create Linear trendline</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>    labs(title<span class="op">=</span><span class="st">'Total Stores vs. Population by Region'</span>,</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>         x<span class="op">=</span><span class="st">'Population (2020 Census)'</span>, y<span class="op">=</span><span class="st">'Total Number of Stores'</span>) <span class="op">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>    theme_bw()</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/var/folders/jb/g1z659_j7g7g3c677k1x2bsc0000gn/T/ipykernel_42033/51356817.py:25: FutureWarning: Using print(plot) to draw and show the plot figure is deprecated and will be removed in a future version. Use plot.show().</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="Lab4_Eldridge_files/figure-html/cell-12-output-2.png" width="640" height="480" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
</div>
<p>From the grpahs above, we can see that Starbucks has the highest amount of stores in the West and Midwest region (Claifornia, Oregon, Washington). Dunkin on the other hand has a stronger presence in the Northeast, with states Like New York and New Jersey. We can also see that the financial impact of having more stores in highly populated regions (like California) versus less populated ones (like Wyoming) reflects how concentrated stores in popular areas can support stock prices. This means that Starbucks benefits from having stores everywhere, while Dunkin’ relies more on selective regional places to conentrate stores. For Starbucks we cans that there is a postive correlation between population and store count. However, for Dunkin we can see there are some outliers having more stores than expected for their population size (Northeast). Finally, yest the financial ata alligns with what we would expect. Starbucks stock data shows that having a wide spread store distribtuionm creates a more steady stock. While Dunkin, relies on key regions in order to sustain finanical performance.</p>
<div id="cell-13" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Automation - McDonald</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>valid_states <span class="op">=</span> [</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Alabama'</span>, <span class="st">'Alaska'</span>, <span class="st">'Arizona'</span>, <span class="st">'Arkansas'</span>, <span class="st">'California'</span>, <span class="st">'Colorado'</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Connecticut'</span>, <span class="st">'Delaware'</span>, <span class="st">'Florida'</span>, <span class="st">'Georgia'</span>, <span class="st">'Hawaii'</span>, <span class="st">'Idaho'</span>, </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Illinois'</span>, <span class="st">'Indiana'</span>, <span class="st">'Iowa'</span>, <span class="st">'Kansas'</span>, <span class="st">'Kentucky'</span>, <span class="st">'Louisiana'</span>, </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Maine'</span>, <span class="st">'Maryland'</span>, <span class="st">'Massachusetts'</span>, <span class="st">'Michigan'</span>, <span class="st">'Minnesota'</span>, </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mississippi'</span>, <span class="st">'Missouri'</span>, <span class="st">'Montana'</span>, <span class="st">'Nebraska'</span>, <span class="st">'Nevada'</span>, </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'New Hampshire'</span>, <span class="st">'New Jersey'</span>, <span class="st">'New Mexico'</span>, <span class="st">'New York'</span>, <span class="st">'North Carolina'</span>, </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'North Dakota'</span>, <span class="st">'Ohio'</span>, <span class="st">'Oklahoma'</span>, <span class="st">'Oregon'</span>, <span class="st">'Pennsylvania'</span>, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rhode Island'</span>, <span class="st">'South Carolina'</span>, <span class="st">'South Dakota'</span>, <span class="st">'Tennessee'</span>, </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Texas'</span>, <span class="st">'Utah'</span>, <span class="st">'Vermont'</span>, <span class="st">'Virginia'</span>, <span class="st">'Washington'</span>, <span class="st">'West Virginia'</span>, </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Wisconsin'</span>, <span class="st">'Wyoming'</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scrape_store_data(url):</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>        company_name <span class="op">=</span> re.search(<span class="vs">r'/location-reports/([^/]+)/?'</span>, url).group(<span class="dv">1</span>).replace(<span class="st">'-'</span>, <span class="st">' '</span>).title()</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Could not extract the company name from the URL."</span>)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>    response.raise_for_status()  </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(response.content, <span class="st">'html.parser'</span>)</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    table <span class="op">=</span> soup.find(<span class="st">'table'</span>)</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> table <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"No table found on the webpage."</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span>  <span class="co"># Stop if no table is found</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> []</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> table.find_all(<span class="st">'tr'</span>)[<span class="dv">1</span>:]:  </span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>        cols <span class="op">=</span> [col.text.strip() <span class="cf">for</span> col <span class="kw">in</span> row.find_all([<span class="st">'th'</span>, <span class="st">'td'</span>])]</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(cols) <span class="op">&gt;=</span> <span class="dv">2</span> <span class="kw">and</span> cols[<span class="dv">0</span>] <span class="kw">in</span> valid_states:</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> cols[<span class="dv">0</span>]</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>            locations <span class="op">=</span> re.sub(<span class="vs">r'[^\d]'</span>, <span class="st">''</span>, cols[<span class="dv">1</span>])  <span class="co">#ChatGPT - Remove non-digit characters</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>            data.append([state, <span class="bu">int</span>(locations)])</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'State'</span>, <span class="st">'Locations'</span>])</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Company'</span>] <span class="op">=</span> company_name</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://www.scrapehero.com/location-reports/McDonalds-USA/'</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> scrape_store_data(url)</span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> df <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.head(<span class="dv">50</span>))  </span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Failed to scrape data from the provided URL."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            State  Locations        Company
0           Texas      11719  Mcdonalds Usa
1         Florida       8786  Mcdonalds Usa
2        Illinois       6405  Mcdonalds Usa
3            Ohio       6135  Mcdonalds Usa
4        New York       5734  Mcdonalds Usa
5        Michigan       5244  Mcdonalds Usa
6    Pennsylvania       4754  Mcdonalds Usa
7  North Carolina       4703  Mcdonalds Usa
8         Georgia       4443  Mcdonalds Usa</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Automation - Wendy's</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bs4 <span class="im">import</span> BeautifulSoup</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>valid_states <span class="op">=</span> [</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Alabama'</span>, <span class="st">'Alaska'</span>, <span class="st">'Arizona'</span>, <span class="st">'Arkansas'</span>, <span class="st">'California'</span>, <span class="st">'Colorado'</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Connecticut'</span>, <span class="st">'Delaware'</span>, <span class="st">'Florida'</span>, <span class="st">'Georgia'</span>, <span class="st">'Hawaii'</span>, <span class="st">'Idaho'</span>, </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Illinois'</span>, <span class="st">'Indiana'</span>, <span class="st">'Iowa'</span>, <span class="st">'Kansas'</span>, <span class="st">'Kentucky'</span>, <span class="st">'Louisiana'</span>, </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Maine'</span>, <span class="st">'Maryland'</span>, <span class="st">'Massachusetts'</span>, <span class="st">'Michigan'</span>, <span class="st">'Minnesota'</span>, </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mississippi'</span>, <span class="st">'Missouri'</span>, <span class="st">'Montana'</span>, <span class="st">'Nebraska'</span>, <span class="st">'Nevada'</span>, </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'New Hampshire'</span>, <span class="st">'New Jersey'</span>, <span class="st">'New Mexico'</span>, <span class="st">'New York'</span>, <span class="st">'North Carolina'</span>, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'North Dakota'</span>, <span class="st">'Ohio'</span>, <span class="st">'Oklahoma'</span>, <span class="st">'Oregon'</span>, <span class="st">'Pennsylvania'</span>, </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rhode Island'</span>, <span class="st">'South Carolina'</span>, <span class="st">'South Dakota'</span>, <span class="st">'Tennessee'</span>, </span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Texas'</span>, <span class="st">'Utah'</span>, <span class="st">'Vermont'</span>, <span class="st">'Virginia'</span>, <span class="st">'Washington'</span>, <span class="st">'West Virginia'</span>, </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Wisconsin'</span>, <span class="st">'Wyoming'</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scrape_store_data(url):</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        company_name <span class="op">=</span> re.search(<span class="vs">r'/location-reports/([^/]+)/?'</span>, url).group(<span class="dv">1</span>).replace(<span class="st">'-'</span>, <span class="st">' '</span>).title()</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Could not extract the company name from the URL."</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    response <span class="op">=</span> requests.get(url)</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    response.raise_for_status() </span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    soup <span class="op">=</span> BeautifulSoup(response.content, <span class="st">'html.parser'</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    table <span class="op">=</span> soup.find(<span class="st">'table'</span>)</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> table <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"No table found on the webpage."</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span>  </span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> []</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> table.find_all(<span class="st">'tr'</span>)[<span class="dv">1</span>:]:  </span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>        cols <span class="op">=</span> [col.text.strip() <span class="cf">for</span> col <span class="kw">in</span> row.find_all([<span class="st">'th'</span>, <span class="st">'td'</span>])]</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(cols) <span class="op">&gt;=</span> <span class="dv">2</span> <span class="kw">and</span> cols[<span class="dv">0</span>] <span class="kw">in</span> valid_states:</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> cols[<span class="dv">0</span>]</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>            locations <span class="op">=</span> re.sub(<span class="vs">r'[^\d]'</span>, <span class="st">''</span>, cols[<span class="dv">1</span>])  <span class="co">#ChatGPT - Remove non-digit characters</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>            data.append([state, <span class="bu">int</span>(locations)])</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'State'</span>, <span class="st">'Locations'</span>])</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'Company'</span>] <span class="op">=</span> company_name</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://www.scrapehero.com/location-reports/Wendys-USA/'</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> scrape_store_data(url)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> df <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(df.head(<span class="dv">50</span>))  </span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Failed to scrape data from the provided URL."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            State  Locations     Company
0           Texas       4678  Wendys Usa
1            Ohio       4077  Wendys Usa
2      California       2975  Wendys Usa
3         Georgia       2975  Wendys Usa
4  North Carolina       2654  Wendys Usa
5    Pennsylvania       2584  Wendys Usa
6        Michigan       2414  Wendys Usa
7        New York       2314  Wendys Usa
8        Virginia       2204  Wendys Usa</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>